{"remainingRequest":"/Users/aaron/myproject/review-open-code/vue.draggable.next/node_modules/babel-loader/lib/index.js!/Users/aaron/myproject/review-open-code/vue.draggable.next/node_modules/eslint-loader/index.js??ref--13-0!/Users/aaron/myproject/review-open-code/vue.draggable.next/src/core/componentStructure.js","dependencies":[{"path":"/Users/aaron/myproject/review-open-code/vue.draggable.next/src/core/componentStructure.js","mtime":1669091380783},{"path":"/Users/aaron/myproject/review-open-code/vue.draggable.next/node_modules/cache-loader/dist/cjs.js","mtime":1642173220293},{"path":"/Users/aaron/myproject/review-open-code/vue.draggable.next/node_modules/babel-loader/lib/index.js","mtime":1669092100647},{"path":"/Users/aaron/myproject/review-open-code/vue.draggable.next/node_modules/eslint-loader/index.js","mtime":1642173233839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvVXNlcnMvYWFyb24vbXlwcm9qZWN0L3Jldmlldy1vcGVuLWNvZGUvdnVlLmRyYWdnYWJsZS5uZXh0L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL2Fhcm9uL215cHJvamVjdC9yZXZpZXctb3Blbi1jb2RlL3Z1ZS5kcmFnZ2FibGUubmV4dC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9Vc2Vycy9hYXJvbi9teXByb2plY3QvcmV2aWV3LW9wZW4tY29kZS92dWUuZHJhZ2dhYmxlLm5leHQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXguanMiOwoKdmFyIGdldEh0bWxFbGVtZW50RnJvbU5vZGUgPSBmdW5jdGlvbiBnZXRIdG1sRWxlbWVudEZyb21Ob2RlKF9yZWYpIHsKICB2YXIgZWwgPSBfcmVmLmVsOwogIHJldHVybiBlbDsKfTsKCnZhciBhZGRDb250ZXh0ID0gZnVuY3Rpb24gYWRkQ29udGV4dChkb21FbGVtZW50LCBjb250ZXh0KSB7CiAgcmV0dXJuIGRvbUVsZW1lbnQuX19kcmFnZ2FibGVfY29udGV4dCA9IGNvbnRleHQ7Cn07Cgp2YXIgZ2V0Q29udGV4dCA9IGZ1bmN0aW9uIGdldENvbnRleHQoZG9tRWxlbWVudCkgewogIHJldHVybiBkb21FbGVtZW50Ll9fZHJhZ2dhYmxlX2NvbnRleHQ7Cn07Cgp2YXIgQ29tcG9uZW50U3RydWN0dXJlID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBDb21wb25lbnRTdHJ1Y3R1cmUoX3JlZjIpIHsKICAgIHZhciBfcmVmMiRub2RlcyA9IF9yZWYyLm5vZGVzLAogICAgICAgIGhlYWRlciA9IF9yZWYyJG5vZGVzLmhlYWRlciwKICAgICAgICBkZWZhdWx0Tm9kZXMgPSBfcmVmMiRub2Rlcy5kZWZhdWx0LAogICAgICAgIGZvb3RlciA9IF9yZWYyJG5vZGVzLmZvb3RlciwKICAgICAgICByb290ID0gX3JlZjIucm9vdCwKICAgICAgICByZWFsTGlzdCA9IF9yZWYyLnJlYWxMaXN0OwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb21wb25lbnRTdHJ1Y3R1cmUpOwoKICAgIHRoaXMuZGVmYXVsdE5vZGVzID0gZGVmYXVsdE5vZGVzOwogICAgdGhpcy5jaGlsZHJlbiA9IFtdLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkoaGVhZGVyKSwgX3RvQ29uc3VtYWJsZUFycmF5KGRlZmF1bHROb2RlcyksIF90b0NvbnN1bWFibGVBcnJheShmb290ZXIpKTsKICAgIHRoaXMuZXh0ZXJuYWxDb21wb25lbnQgPSByb290LmV4dGVybmFsQ29tcG9uZW50OwogICAgdGhpcy5yb290VHJhbnNpdGlvbiA9IHJvb3QudHJhbnNpdGlvbjsKICAgIHRoaXMudGFnID0gcm9vdC50YWc7CiAgICB0aGlzLnJlYWxMaXN0ID0gcmVhbExpc3Q7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQ29tcG9uZW50U3RydWN0dXJlLCBbewogICAga2V5OiAiX2lzUm9vdENvbXBvbmVudCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMuZXh0ZXJuYWxDb21wb25lbnQgfHwgdGhpcy5yb290VHJhbnNpdGlvbjsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW5kZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcihoLCBhdHRyaWJ1dGVzKSB7CiAgICAgIHZhciB0YWcgPSB0aGlzLnRhZywKICAgICAgICAgIGNoaWxkcmVuID0gdGhpcy5jaGlsZHJlbiwKICAgICAgICAgIF9pc1Jvb3RDb21wb25lbnQgPSB0aGlzLl9pc1Jvb3RDb21wb25lbnQ7CiAgICAgIHZhciBvcHRpb24gPSAhX2lzUm9vdENvbXBvbmVudCA/IGNoaWxkcmVuIDogewogICAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgICAgcmV0dXJuIGNoaWxkcmVuOwogICAgICAgIH0KICAgICAgfTsKICAgICAgcmV0dXJuIGgodGFnLCBhdHRyaWJ1dGVzLCBvcHRpb24pOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZWQoKSB7CiAgICAgIHZhciBkZWZhdWx0Tm9kZXMgPSB0aGlzLmRlZmF1bHROb2RlcywKICAgICAgICAgIHJlYWxMaXN0ID0gdGhpcy5yZWFsTGlzdDsKICAgICAgZGVmYXVsdE5vZGVzLmZvckVhY2goZnVuY3Rpb24gKG5vZGUsIGluZGV4KSB7CiAgICAgICAgYWRkQ29udGV4dChnZXRIdG1sRWxlbWVudEZyb21Ob2RlKG5vZGUpLCB7CiAgICAgICAgICBlbGVtZW50OiByZWFsTGlzdFtpbmRleF0sCiAgICAgICAgICBpbmRleDogaW5kZXgKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0VW5kZXJseWluZ1ZtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRVbmRlcmx5aW5nVm0oZG9tRWxlbWVudCkgewogICAgICByZXR1cm4gZ2V0Q29udGV4dChkb21FbGVtZW50KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRWbUluZGV4RnJvbURvbUluZGV4IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRWbUluZGV4RnJvbURvbUluZGV4KGRvbUluZGV4LCBlbGVtZW50KSB7CiAgICAgIHZhciBkZWZhdWx0Tm9kZXMgPSB0aGlzLmRlZmF1bHROb2RlczsKICAgICAgdmFyIGxlbmd0aCA9IGRlZmF1bHROb2Rlcy5sZW5ndGg7CiAgICAgIHZhciBkb21DaGlsZHJlbiA9IGVsZW1lbnQuY2hpbGRyZW47CiAgICAgIHZhciBkb21FbGVtZW50ID0gZG9tQ2hpbGRyZW4uaXRlbShkb21JbmRleCk7CgogICAgICBpZiAoZG9tRWxlbWVudCA9PT0gbnVsbCkgewogICAgICAgIHJldHVybiBsZW5ndGg7CiAgICAgIH0KCiAgICAgIHZhciBjb250ZXh0ID0gZ2V0Q29udGV4dChkb21FbGVtZW50KTsKCiAgICAgIGlmIChjb250ZXh0KSB7CiAgICAgICAgcmV0dXJuIGNvbnRleHQuaW5kZXg7CiAgICAgIH0KCiAgICAgIGlmIChsZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQoKICAgICAgdmFyIGZpcnN0RG9tTGlzdEVsZW1lbnQgPSBnZXRIdG1sRWxlbWVudEZyb21Ob2RlKGRlZmF1bHROb2Rlc1swXSk7CgogICAgICB2YXIgaW5kZXhGaXJzdERvbUxpc3RFbGVtZW50ID0gX3RvQ29uc3VtYWJsZUFycmF5KGRvbUNoaWxkcmVuKS5maW5kSW5kZXgoZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICByZXR1cm4gZWxlbWVudCA9PT0gZmlyc3REb21MaXN0RWxlbWVudDsKICAgICAgfSk7CgogICAgICByZXR1cm4gZG9tSW5kZXggPCBpbmRleEZpcnN0RG9tTGlzdEVsZW1lbnQgPyAwIDogbGVuZ3RoOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIENvbXBvbmVudFN0cnVjdHVyZTsKfSgpOwoKZXhwb3J0IHsgQ29tcG9uZW50U3RydWN0dXJlIH07"},{"version":3,"sources":["/Users/aaron/myproject/review-open-code/vue.draggable.next/src/core/componentStructure.js"],"names":["getHtmlElementFromNode","el","addContext","domElement","context","__draggable_context","getContext","ComponentStructure","nodes","header","defaultNodes","default","footer","root","realList","children","externalComponent","rootTransition","transition","tag","h","attributes","_isRootComponent","option","forEach","node","index","element","domIndex","length","domChildren","item","firstDomListElement","indexFirstDomListElement","findIndex"],"mappings":"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","sourcesContent":["const getHtmlElementFromNode = ({ el }) => el;\nconst addContext = (domElement, context) =>\n  (domElement.__draggable_context = context);\nconst getContext = domElement => domElement.__draggable_context;\n\nclass ComponentStructure {\n  constructor({\n    nodes: { header, default: defaultNodes, footer },\n    root,\n    realList\n  }) {\n    this.defaultNodes = defaultNodes;\n    this.children = [...header, ...defaultNodes, ...footer];\n    this.externalComponent = root.externalComponent;\n    this.rootTransition = root.transition;\n    this.tag = root.tag;\n    this.realList = realList;\n  }\n\n  get _isRootComponent() {\n    return this.externalComponent || this.rootTransition;\n  }\n\n  render(h, attributes) {\n    const { tag, children, _isRootComponent } = this;\n    const option = !_isRootComponent ? children : { default: () => children };\n    return h(tag, attributes, option);\n  }\n\n  updated() {\n    const { defaultNodes, realList } = this;\n    defaultNodes.forEach((node, index) => {\n      addContext(getHtmlElementFromNode(node), {\n        element: realList[index],\n        index\n      });\n    });\n  }\n\n  getUnderlyingVm(domElement) {\n    return getContext(domElement);\n  }\n\n  getVmIndexFromDomIndex(domIndex, element) {\n    const { defaultNodes } = this;\n    const { length } = defaultNodes;\n    const domChildren = element.children;\n    const domElement = domChildren.item(domIndex);\n\n    if (domElement === null) {\n      return length;\n    }\n    const context = getContext(domElement);\n    if (context) {\n      return context.index;\n    }\n\n    if (length === 0) {\n      return 0;\n    }\n    const firstDomListElement = getHtmlElementFromNode(defaultNodes[0]);\n    const indexFirstDomListElement = [...domChildren].findIndex(\n      element => element === firstDomListElement\n    );\n    return domIndex < indexFirstDomListElement ? 0 : length;\n  }\n}\n\nexport { ComponentStructure };\n"]}]}